For more examples on fitting bursts data and plotting results, refer to the
fitting section of the μs-ALEX notebook (\href{http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/FRETBursts%20-%20us-ALEX%20smFRET%20burst%20analysis.ipynb#FRET-fit:-in-depth-example}{link}),
the \textit{Fitting Framework} section of the documentation
(\href{http://fretbursts.readthedocs.org/en/latest/fit.html}{link})
as well as the documentation for \verb|bursts_fitter| function
(\href{http://fretbursts.readthedocs.org/en/latest/plugins.html#fretbursts.burstlib_ext.bursts_fitter}{link}).

\paragraph{Python details}

Models returned by FRETBursts's factory functions (\verb|mfit.factory_*|)
are \verb|lmfit.Model| objects (\href{https://lmfit.github.io/lmfit-py/model.html}{link}).
Custom models can be created by calling \verb|lmfit.Model| directly.
When an \verb|lmfit.Model| is fitted, it returns a \verb|ModelResults| object
(\href{https://lmfit.github.io/lmfit-py/model.html#the-modelresult-class}{link}),
which contains all information related to the fit (model, data,
parameters with best values and uncertainties) and useful methods to operate on fit results.
FRETBursts puts a \verb|ModelResults| object of each excitation spot in the list
\verb|ds.E_fitter.fit_res|.
For instance, to obtain the reduced $\chi^2$ value of the E histogram fit in a
single-spot measurement \verb|d|, we use the following command:

\begin{lstlisting}
d.E_fitter.fit_res[0].redchi
\end{lstlisting}

Other useful attributes are \verb|aic| and \verb|bic| which contain the
Akaike information criterion (AIC) and the Bayes Information criterion (BIC).
AIC and BIC allow comparing different models and
selecting the most appropriate for the data at hand.

Examples of definition and modification of fit models are provided in
the aforementioned μs-ALEX notebook
(\href{http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/FRETBursts%20-%20us-ALEX%20smFRET%20burst%20analysis.ipynb#FRET-fit:-in-depth-example}{link}).
Users can also refer to the comprehensive lmfit's documentation
(\href{http://lmfit.github.io/lmfit-py/}{link}).

\subsection{FRET Dynamics}
\label{sec:dynamics}

FRET peaks resolved from FRET histograms correspond to different FRET
populations. However determining whether these populations are due to static
heterogeneity (different D-A distances, Förster radius, etc.) or a
dynamic equilibrium, requires further analysis.

Shot-noise analysis (SNA)~\cite{Nir_2006} or probability
distribution analysis (PDA)~\cite{Antonik2006} allow to compute
the minimal width of a FRET peak originating from a single
FRET efficiency. Typically, several mechanisms
contribute to the broadening of the experimental FRET peak
beyond the shot-noise limit. For example, heterogeneities in the sample
(resulting in a distribution of Förster radiuses)
or actual conformational changes (resulting in a distribution
of D-A distances) can cause FRET peak broadening~\cite{sisamakis_accurate_2010}.

Kalinin~\cite{Kalinin2010} and Santoso~\cite{santoso_probing_2009}
extended the PDA approach to estimate conversion rates between different
states by comparing FRET histograms as a function of the time-bin size.
Gopich and Szabo~\cite{Gopich2009, gopich_theory_2011} developed
a related method to compute conversion rates using
a likelihood function which depends on photon timestamps (overcoming
the time binning and FRET histogramming step).
Hoffman~\cite{hoffmann_quantifying_2011} extended the
timescale of detectable kinetics by considering multiple subsequent bursts
and computing the probability that two nearby bursts are originating from
the same molecules.
Other two related methods are Burst Variance Analysis
(BVA)~\cite{Torella_2011} and
kernel density distribution estimator (2CDE)~\cite{Tomov_2012}
which allow to discriminate between static heterogeneity
and sub-millisecond dynamics by extracting information
from the photon distribution within each burst.

The last two methods, BVA and 2CDE, are implemented
in two notebooks included with FRETBursts
(\href{http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%20Burst%20Variance%20Analysis.ipynb}{BVA link},
\href{http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%202CDE%20Method.ipynb}{2CDE link}).
The other methods are not currently implemented in FRETBursts.
However, motivated users can implement their favorite method
leveraging the burst manipulation functions in FRETBursts
and the standard scientific Python libraries. We encourage researchers
coding new methods with FRETBursts to share their contributions and
to integrate their work in FRETBursts in order to benefit the entire community.
The next section, takes the BVA method as an example for showing how to
perform low-level manipulation of timestamps and bursts data.
An additional example showing how to split bursts in constant time-bins
can be found in the respective FRETBursts notebook
(\href{http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/Example%20-%20Working%20with%20timestamps%20and%20bursts.ipynb}{link}).
These examples server as a guide for implementing new methods
using FRETBursts.

