\subsection{Burst Weights}
\label{sec:burstweights_theory}
\subsubsection{Theoretical Foundation}
In homogeneous FRET population, burst counts in the acceptor channel can be
modeled as a binomial random variable (RV) with success probability equal to the
population PR and number of trials equal to the burst size $n_d + n_a$.
Similarly, the PR of each burst $E_i$ ($i$ being the burst index) is 
simply a binomial divided by the number of trials, therefore the variance is:

\begin{equation}
\label{eq:E_var}
\operatorname{Var} (E_i) = \frac{E_p\,(1 - E_p)}{n_{ti}}
\end{equation}

For a single FRET population, freely-diffusing molecules across 
a Gaussian excitation volume give rise to 
a burst size distribution that is exponentially distributed.
From eq.~\ref{eq:E_var} we see that bursts with larger burst size
will yield more accurate estimations of the population PR
(since their variance will be smaller). Therefore, in estimating the 
population PR we need to put bigger weights on larger bursts.
In the following paragraphs we demonstrate that the optimal weights
are proportional to the burst size.

According to the Cramer-Rao lower bound (eq.~\ref{eq:cramer_rao}), the 
Fisher information \mathcal{I}(\theta) sets a lower bound on the
variance of any statistics $\hat{p}$ of a RV $theta$.

\begin{equation}
\label{eq:cramer_rao}
\operatorname{Var}\left(\hat{p}\right) \ge \frac{1}{\mathcal{I}(\theta)}
\end{equation}

When the statistics $\hat{p}$ is an unbiased estimator of a distribution 
parameter and the equality holds in eq.~\ref{eq:cramer_rao},
the estimator is a minimum-variance unbiased estimator (MVUB)
and the estimator is said to be efficient (meaning that it does an
optimal use the information contained in the sample to estimate the
parameter).

A population of $N$ bursts can be modeled by a set of $N$ binomial
variables with same success probability $E_p$ and varying number of successes
equal to the burst size. Now, notice that the sum of binomial RV with same 
success probability is still a binomial (with number of trial equal to 
the sum of the number of trials).
Therefore we can build an estimator for $E_p$ by computing the proportion of
success from the sum over all bursts of acceptor counts o divided by the total
number of photons as in eq.~\ref{eq:E_estim}.

\begin{equation}
\label{eq:E_estim}
\hat{E} = \frac{\sum_i n_{ai}}{\sum_i n_{ti}}
\end{equation}

The variance of $\hat{E}$ (eq.~\ref{eq:E_variance}) is equal to the inverse of 
the Fisher information $\mathcal{I}(\hat{E})$ and therefore $\hat{E}$ is a MVUB 
estimator for $E_p$.

\begin{equation}
\label{eq:E_variance}
\operatorname{Var}(\hat{E}) = \frac{E_p (1 - E_p)}{\sum_i n_{ti}} = \frac{1}{\mathcal{I}(\hat{E})}
\end{equation}

Finally, we can verify that $\hat{E}$ is equal to the weighted average of the bursts
PR $E_i$ (eq.~\ref{eq:E_wmean}), with weights proportional to the burst size (eq.~\ref{eq:weights}).

\begin{equation}
\label{eq:weights}
w_i
= \frac{n_{ti}}{\sum_i n_{ti}}
\end{equation}

\begin{equation}
\label{eq:E_wmean}
\hat{E}_w = \frac{1}{N} \sum_i w_i E_i 
= \frac{1}{N} \frac{\sum_i n_{ti} \frac{n_{ai}}{n_{ti}} }{\sum_i n_{ti}} = \hat{E}
\end{equation}

Since $\hat{E}$ is the MVUB estimator, any other estimator of $E_p$ (in particular 
the unweighted mean of $E_i$) will have a larger variance.
Finally, we can extend these consideration of optimal weights for 
the PR estimator to the plot of the actual FRET distribution. Building an
unweighted histogram and fitting the peak is analogous to estimating the 
$E_p$ with an unweighted average. Conversely, building the FRET histogram
using the burst size as weights and fitting the peak is equivalent to using
the MVUB estimator for $E_p$.

\subsubsection{Simulations}
It is easy to illustrate the results of previous section through simulations.
In particular we generate a static FRET population of bursts extracting sizes 
from an exponential (or gamma) distribution and acceptor counts from a binomial
distribution. By repeatedly fitting the population parameter $E_p$ using a 
size-weighted and unweighted average, we verified that the former has systematically
lower variance of the latter as predicted by the theory. Note that this result
holds for any arbitrary distribution of burst sizes.

\subsubsection{Experiments}
Figure X show a comparison of a FRET histogram obtained from the same burst
with and without weights. The burst selection is obtained applying a burst size
of threshold of 20 counts, in order to filter the extreme low-end of the burst size
distribution which include background bursts.

The use of size-weighted FRET histograms allows to obtain a minimal with of
the various FRET peaks without the need of using a manually adjusted high
threshold for burst selection. While an increase in the selection threshold
reduces the shot-noise of the residual population it also discards the useful 
information of low and medium size bursts. Necessarly, an unweighted histograms
with high selection threshold will exhibit an higher statistical noise
(due to the reduced number of bursts) compared to the size-weighted histogram
obtained using a low threshold.
statistical variance
