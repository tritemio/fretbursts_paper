\subsection{Background Estimation With Optimal Threshold}
\label{sec:bg_opt_th}
The functions used to fit the background (i.e. \verb|bg.exp_fit| and other functions in \verb|bg| module)
provide also a goodness-of-fit estimator 
computed from the empirical distribution function (EDF)~\cite{Stephens1974,Parr1980}. 
The ``distance'' between the EDF and the theoretical (i.e. exponential) cumulative distribution
represents and indicator of the quality of fit.
Two different distance metrics can be returned by the background fitting functions.
The first is the Kolgomorov-Smirnov statistics, which uses the maximum of the difference 
between the EDF and the theoretical distribution. The second is the Cram√©r von Mises
statistics corresponding to the integral of the squared residuals
(see the code for more details,
\href{https://github.com/tritemio/FRETBursts/blob/master/fretbursts/background.py#L43}{link}).

In principle, the optimal inter-photon delay threshold will minimize
the error metric. This approach is implemented by the function \verb|calc_bg_brute|
(\href{http://fretbursts.readthedocs.org/en/latest/plugins.html#fretbursts.burstlib_ext.calc_bg_brute}{link}) which performs a brute-force search in order to find the optimal threshold.
This optimization is not necessary under typical experimental conditions, 
because the estimated rates normally change only a by a few per-cent 
compared to the heuristic threshold selection used by default.
