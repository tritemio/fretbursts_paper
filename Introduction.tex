\section{Introduction}

\subsection{Open Science and Reproducibility}

In the last 20 years, single molecule FRET (smFRET), has emerged as one of the most
useful techniques in single-molecule spectroscopy~\cite{Weiss_1999,Hohlbein_2014}. 
Except a few specific ensemble time-resolved measurements~\cite{Lerner_2014,Rahamim_2015}, 
smFRET unique feature is the ability to resolve conformational 
changes of biomolecules or measure binding-unbinding kinetics on heterogeneous samples. 
smFRET measurements on freely diffusing molecules (the focus of this paper) have the advantage 
of probing molecules and processes without possible perturbation from surface 
immobilization~\cite{Dahan_1999,Eggeling_1998}. 

The field of freely-diffusing smFRET data analysis, has seen a number of significant 
contributions over the 
years~\cite{Fries_1998,Eggeling_2001,Zhang_2005,Gopich_2005,Lee_2005,Nir_2006,Antonik2006,Gopich_2007,Gopich_2008,Camley_2009,Santoso_2010,Torella_2011,Tomov_2012}. 
Historically, each research group have implemented its own private version
of analysis software (oftentimes highly dependent on a particular setup
configuration) with almost no collaboration or code sharing.
Even in our group, past smFRET papers merely mention the usage of custom-made software without 
additional details~\cite{Lee_2005,Nir_2006}.
This situation makes it hard to reproduce and validate and to build upon 
results from different groups.
Moreover, as new methods are proposed in literature, 
it is oftentimes hard to quantify their performances.
An independent quantitative assessment
would require a complete reimplementation, an effort a few groups can afford.
As a results, potentially useful analysis improvements
are rarely adopted by the community at large.
In contrast with other consolidated traditions such as 
sharing protocols and samples, for scientific software,
we have relegated ourselves to islands of non-communication.

From a more general stance, non-availabilty of codes 
used for scientific results, hinders reproducibility, 
makes it impossible to review and validate the software correctness
and prevents improvements and extensions by other scientists.
This situation, common in many disciplines, 
represents a real impediment to the scientific progress.
Since pioneering work of Donoho group in the 90's~\cite{Buckheit_1995},
it has become evident that developing and maintaining open source scientific software
for reproducible research is a critical requirement of modern 
sciencific enterprice~\cite{Ince_2012,Vihinen_2015}. 

%Peer-reviewed publications describing such software are also necessary~\cite{Pradal_2013}, 
%although the debate is still open on the most effective model for peer-reviewing this
%class of publications~\cite{Check_Hayden_2013,Check_Hayden_2015} 
%(\href{https://software-carpentry.org/blog/2015/04/quality-is-free-getting-there-isnt.html}{Willson 2015})
%(\href{https://www.mozillascience.org/effective-code-review-for-journals}{Mills 2015})
%(\href{http://ivory.idyll.org/blog/2015-we-live-in-a-bubble.html}{Brown 2015} and \href{http://ivory.idyll.org/blog/on-code-review-of-scientific-code.html}{2013}).

Facing these issues, we developed FRETBursts, 
an open source Python software for burst analysis of freely-diffusing
single-molecule FRET experiments. 
With FRETBursts we provide a tool that is available to any scientist
to use, inspect and modify. FRETBursts is suitable for routine state-of-the-art 
analysis of smFRET data but also represents an ideal platform 
for quantitative comparison of different methods in burst analysis.
To facilitate reproducibility of complete analysis
workflows, FRETBursts execution model is based on Juyter Notebook~\cite{Shen_2014}.
A notebook contains a narrative, input paramenters, code and 
results in a single document that is easy to share and re-execute.
To minimize chance of bugs we employ modern software engineering techniques
such as unit testing and continuous integration.
FRETBursts is hosted and openly developed on GitHub~\cite{Blischak_2016,Prli__2012}, 
where users can send comments, report issues or contribute code.
In a parallel effort, we recently introduced Photon-HDF5,
a open file format for timestamp-based single-molecule fluorescence 
experiments~\cite{Ingargiola2016}. Together with Photon-HDF5,
FRETBursts contributes to the ecosystem
of open tools for reproducible science in the single-molecule field.


\subsection{Paper Overview}
Since understanding smFRET burst analysis requires several concepts and definitions,
in this paper, we provide an introduction to smFRET bursts analysis and 
how different steps are executed in FRETBursts. 
We will no cover all FRETBursts
features and options but provide an overview detailed enough for starting
using FRETBursts and customizing the analysis. For additional information, 
we refer the reader to the FRETBursts Reference Documentation
(\href{http://fretbursts.readthedocs.org/}{link}) and to
the FRETBursts Âµs-ALEX notebook
(\href{http://nbviewer.jupyter.org/github/tritemio/FRETBursts_notebooks/blob/master/notebooks/FRETBursts%20-%20us-ALEX%20smFRET%20burst%20analysis.ipynb}{link})
Finally, usage questions can be posted by  opening an Issue
on GitHub (\href{https://github.com/tritemio/FRETBursts}{link}).

The paper is structured as follows.
In section~\ref{sec:overview} we give an overview of the software features,
the modality of execution and the development style.
In section~\ref{sec:concepts}, we
review basic concepts and terminology needed
to understand the smFRET burst analysis.
In section~\ref{sec:analysis}, we detail the execution the main steps involved
in smFRET burst analysis: data loading (section~\ref{sec:dataload}), defining
excitation alternation periods (section~\ref{sec:alternation}), background
correction (section~\ref{sec:bg_calc}), burst search (section~\ref{sec:burstsearch}),
burst selection (section~\ref{sec:burstsel}) and FRET fitting (section~\ref{sec:fretfit}).
The aim is to provide the reader with enough information to understand the specificities of
the different algorithms and to be able to adapt the analysis to new situations.
In section~\ref{sec:bva}, we show how to implement a new burst analysis in FRETBursts,
taking as an example the Burst Variance Analysis (BVA)~\cite{Torella_2011}.
In section~\ref{sec:dev} we describe the development process, the testing infrastructure 
and contributors guidelines.
Finally, in section~\ref{sec:conclusions}, we summarize what we believe to be
the strengths of FRETBursts software.

Throughout this paper,
links to relevant sections of documentation and other web resources
are displayed as ``(link)''.
In order to make the text accessible to the widest number of readers,
we concentrated python-specific details in special subsections titled
\textit{Python details}. These subsections provide deeper insights for readers
already familiar with python and can be safely skipped otherwise. 
Finally, note that all commands here reported can be found in the 
accompanying notebooks 
(\href{https://github.com/tritemio/fretbursts_paper}{link}).

